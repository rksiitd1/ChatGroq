(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[929],{44980:function(e,t,s){Promise.resolve().then(s.bind(s,96906))},96906:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return u}});var a=s(57437),r=s(2265),l=s(16463),n=s(64392),i=s(24635),c=s(34446),o=s(7476),x=s(44025),d=s(87347),h=s(88904);function u(){let[e,t]=(0,r.useState)(""),[s,u]=(0,r.useState)([]),[g,m]=(0,r.useState)(!1),[y,f]=(0,r.useState)(!1),[p,b]=(0,r.useState)(!1),[j,N]=(0,r.useState)(""),[w,v]=(0,r.useState)(null),C=(0,l.useRouter)(),k=(0,n.createClientComponentClient)(),S=(0,r.useRef)(null),[z,E]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{let{data:{session:e}}=await k.auth.getSession();e||C.push("".concat("/ChatGroq","/login"))})(),_()},[C]),(0,r.useEffect)(()=>{S.current&&(S.current.scrollTop=S.current.scrollHeight)},[s]);let _=async()=>{let{data:e,error:t}=await k.from("chat_history").select("*").order("created_at",{ascending:!0});t?console.error("Error loading chat history:",t):u(e)},O=async s=>{if(s.preventDefault(),!e.trim())return;let a={role:"user",content:e};u(e=>[...e,a]),t(""),m(!0);try{let t=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})}),s=await t.json();if(s.error)throw Error(s.error);let r={role:"assistant",content:s.response};u(e=>[...e,r]),await k.from("chat_history").insert([a,r])}catch(e){console.error("Error:",e),alert("Failed to get response from AI: "+e.message)}finally{m(!1)}},A=async()=>{await k.auth.signOut(),C.push("".concat("/ChatGroq","/"))},T=async()=>{window.confirm("Are you sure you want to clear the chat history?")&&(await k.from("chat_history").delete().neq("id",0),u([]))},q=e=>{navigator.clipboard.writeText(e).then(()=>{alert("Copied to clipboard!")})},L=s.filter(e=>e.content.toLowerCase().includes(j.toLowerCase()));return(0,a.jsxs)("div",{className:"flex h-screen ".concat(p?"bg-gray-900 text-white":"bg-gray-100 text-gray-900"),children:[(0,a.jsxs)(i.E.aside,{initial:{x:"-100%"},animate:{x:y?0:"-100%"},transition:{type:"spring",stiffness:300,damping:30},className:"fixed top-0 left-0 z-50 w-64 h-full ".concat(p?"bg-gray-800":"bg-white"," shadow-lg"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Chat History"}),(0,a.jsx)("button",{onClick:()=>f(!1),className:"text-gray-500 hover:text-gray-700",children:(0,a.jsx)(o.q5L,{size:24})})]}),(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)("input",{type:"text",placeholder:"Search messages...",value:j,onChange:e=>N(e.target.value),className:"w-full p-2 rounded-md ".concat(p?"bg-gray-700 text-white":"bg-gray-100 text-gray-900")})}),(0,a.jsx)("nav",{className:"p-4 overflow-y-auto h-[calc(100%-8rem)] custom-scrollbar",children:L.map((e,t)=>(0,a.jsxs)("div",{className:"mb-2 p-2 hover:bg-gray-100 rounded cursor-pointer ".concat(p?"hover:bg-gray-700":"hover:bg-gray-200"),onClick:()=>v(e),children:[(0,a.jsx)("span",{className:"font-medium ".concat("user"===e.role?"text-blue-600":"text-green-600"),children:"user"===e.role?"You: ":"AI: "}),(0,a.jsxs)("span",{className:"truncate",children:[e.content.substring(0,30),"..."]})]},t))})]}),(0,a.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,a.jsx)("header",{className:"".concat(p?"bg-gray-800":"bg-white"," shadow-sm"),children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center py-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("button",{onClick:()=>f(!0),className:"text-gray-500 hover:text-gray-700 mr-4",children:(0,a.jsx)(o.cur,{size:24})}),(0,a.jsx)("h1",{className:"text-2xl font-semibold",children:"ChatGroq"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("button",{onClick:()=>{b(!p)},className:"text-gray-500 hover:text-gray-700",children:p?(0,a.jsx)(o.kXG,{size:24}):(0,a.jsx)(o.wOW,{size:24})}),(0,a.jsx)("button",{onClick:()=>{let e="data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(s)),t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("download","chat_history.json"),t.click()},className:"text-gray-500 hover:text-gray-700",children:(0,a.jsx)(o._hL,{size:24})}),(0,a.jsxs)("label",{className:"cursor-pointer",children:[(0,a.jsx)("input",{type:"file",className:"hidden",onChange:e=>{let t=e.target.files[0];if(t){let e=new FileReader;e.onload=e=>{try{let t=JSON.parse(e.target.result);u(t)}catch(e){console.error("Error parsing imported file:",e),alert("Failed to import chat history. Please ensure the file is valid JSON.")}},e.readAsText(t)}},accept:".json"}),(0,a.jsx)(o.Yjd,{size:24,className:"text-gray-500 hover:text-gray-700"})]}),(0,a.jsx)("button",{onClick:T,className:"text-gray-500 hover:text-gray-700",children:(0,a.jsx)(o.Ybf,{size:24})}),(0,a.jsx)("button",{onClick:A,className:"text-gray-500 hover:text-gray-700",children:(0,a.jsx)(o.xqh,{size:24})})]})]})})}),(0,a.jsx)("main",{className:"flex-1 overflow-hidden ".concat(z?"fixed inset-0 z-50 bg-white":""),children:(0,a.jsxs)("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 h-full flex flex-col py-8",children:[(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto custom-scrollbar",ref:S,children:[(0,a.jsx)(c.M,{children:L.map((e,t)=>(0,a.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"mb-4 ".concat("user"===e.role?"text-right":"text-left"),children:(0,a.jsxs)("div",{className:"inline-block p-3 rounded-lg max-w-[80%] ".concat("user"===e.role?p?"bg-blue-600 text-white":"bg-blue-100 text-blue-900":p?"bg-gray-700 text-white":"bg-gray-200 text-gray-900"),children:[(0,a.jsx)(h.U,{components:{code(e){let{node:t,inline:s,className:r,children:l,...n}=e,i=/language-(\w+)/.exec(r||"");return!s&&i?(0,a.jsx)(x.Z,{style:d.Z,language:i[1],PreTag:"div",...n,children:String(l).replace(/\n$/,"")}):(0,a.jsx)("code",{className:r,...n,children:l})}},children:e.content}),(0,a.jsxs)("button",{onClick:()=>q(e.content),className:"mt-2 text-xs text-gray-500 hover:text-gray-700",children:[(0,a.jsx)(o.C3L,{size:12,className:"inline mr-1"})," Copy"]})]})},t))}),g&&(0,a.jsx)("div",{className:"text-gray-500 italic",children:"AI is typing..."})]}),(0,a.jsx)("div",{className:"py-4",children:(0,a.jsxs)("form",{onSubmit:O,className:"flex items-center",children:[(0,a.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"Type your message...",className:"flex-1 p-2 rounded-l-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(p?"bg-gray-700 text-white":"bg-white text-gray-900")}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-r-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:(0,a.jsx)(o.LbG,{size:20})})]})})]})})]}),w&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full ".concat(p?"bg-gray-800 text-white":"bg-white text-gray-900"),children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Message Details"}),(0,a.jsx)(h.U,{children:w.content}),(0,a.jsx)("div",{className:"mt-4 flex justify-end",children:(0,a.jsx)("button",{onClick:()=>v(null),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300",children:"Close"})})]})})]})}}},function(e){e.O(0,[956,880,739,971,23,744],function(){return e(e.s=44980)}),_N_E=e.O()}]);